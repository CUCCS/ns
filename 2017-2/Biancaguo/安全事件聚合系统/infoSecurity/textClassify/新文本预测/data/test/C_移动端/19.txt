

在移动设备上，速度和节能至关重要。加密操作非常复杂，如果在设计和实施时未考虑这两个重要因素，可能会带来一些性能或电池续航方面的问题。每台 iOS 设备都配备了专用的 AES 256 加密引擎，它内置于闪存与主系统内存之间的 DMA 路径中，可以实现高效的文件加密。设备的唯一 ID (UID) 和设备组 ID (GID) 是 AES 256 位密钥，密钥已在制造过程中被固化 (UID)或编译 (GID) 在应用程序处理器和 Secure Enclave 中。任何软件或固件都无法直接读取这些ID;而只能查看由植入于硅片中的专用 AES 引擎将 UID 或 GID 用作密钥所执行的加密或解密操作结果。此外，只有专用于 Secure Enclave 的 AES 引擎才能使用 Secure Enclave 的 UID 和GID。每台设备的 UID 都是唯一的，Apple 或其任何其供应商都没有记录在案。GID 对于同一类设备(例如，使用 Apple A8 处理器的所有设备)的所有处理器是通用的，它可用于非高安全性的任务，例如在安装和恢复过程中交付系统软件。将这些密钥集成到硅片中可防止篡改或绕过它们，或在 AES 引擎外部对其进行访问。UID 和 GID 也不可以通过 JTAG 或其他调试接口使用。利用 UID 可以采用加密方式将数据与特定设备捆绑起来。例如，用于保护文件系统的密钥层次结构包括 UID，因此如果将内存芯片从一台设备整个移至另一台设备，文件将不可访问。UID 与设备上的任何其他标识符都无关。除了 UID 和 GID，所有其他加密密钥都由系统的随机数生成器 (RNG) 使用基于 CTR_DRBG 的算法创建。系统熵是在启动期间从时间变化以及设备启动后从中断计时中生成的。在 Secure Enclave 内部生成的密钥使用真正的硬件随机数生成器，通过基于 CTR_DRBG 处理的多个环形振荡器创建而成。