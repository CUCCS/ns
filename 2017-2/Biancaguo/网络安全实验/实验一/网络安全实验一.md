网络安全实验报告

	
# 实验一 基于VirtualBox的网络攻防基础环境搭建实例讲解 （改） #

## 一、实验目的 ##

熟悉virtualBox操作系统网络连接方式，掌握网关的配置和网络拓扑结构，搭建起基于VB的网络攻防实验环境。

## 二、实验要求及完成情况 ##

 * 节点：靶机、网关、攻击者主机 ok
    * 连通性
        * 靶机可以直接访问攻击者主机 ok
        * 攻击者主机无法直接访问靶机 ok
        * 网关可以直接访问攻击者主机和靶机 ok
        * 靶机的所有对外上下行流量必须经过网关 ok
        * 所有节点均可以访问互联网 ok
    * 其他要求
        * 所有节点制作成基础镜像（多重加载的虚拟硬盘）ok
        

## 三、实验结果展示 ##

1、节点

（1）靶机（KaliVictim）

配置方法：手动

* Eth1（内部网络）: **IP 192.168.0.10  网关 192.168.0.11**

![](https://i.imgur.com/LJeGpYp.png)

（2）网关（KaliGateway）

配置方法：dhcp（dhclient）

* Eth0（桥接网络）: **IP 192.168.1.101  网关 192.168.1.1**
 
* Eth1（内部网络）: **IP 192.168.0.11   网关 192.168.0.1**

![](https://i.imgur.com/mPgr0AC.png)

（3）攻击者主机（KaliAttack）

配置方法：dhcp（dhclient）

* Eth0（桥接网络）: **IP 192.168.1.106   网关 192.168.1.1**
 
![](https://i.imgur.com/QMuAaSv.png)

2、连通性

* 靶机可以直接访问攻击者主机

![](https://i.imgur.com/xkWpKbW.png)

* 攻击者主机无法直接访问靶机

![](https://i.imgur.com/lnmJCfz.png)

* 网关可以直接访问攻击者主机和靶机

![](https://i.imgur.com/1XnyI5u.png)

* 靶机的所有对外上下行流量必须经过网关

![](https://i.imgur.com/Tm8Wmpy.jpg)

* 所有节点均可以访问互联网

（1）网关

![](https://i.imgur.com/25yWuqr.png)

（2）靶机

![](https://i.imgur.com/ZO0kltZ.jpg)

（3）攻击者主机

![](https://i.imgur.com/QSwueb7.png)

3、其他要求

* 所有节点制作成基础镜像（多重加载的虚拟硬盘）

（1）靶机

![](https://i.imgur.com/tkMgmx1.png)

（2）攻击者

![](https://i.imgur.com/YbCmhMu.png)

（3）网关

![](https://i.imgur.com/MdK3H3r.png)

## 四、实验步骤 ##

1、为网关配置NAT转发服务

在网关上操作：

（1）打开linux的转发功能：`sysctl net.ipv4.ip_forward=1 `

（2）将FORWARD链的策略设置为DROP，这样做的目的是做到对内网ip的控制：`iptables -P FORWARD DROP`

（3）这条规则规定允许任何地址到任何地址的确认包和关联包通过：`iptables -A FORWARD -m state --state ESTABLISHED,RELATED -j ACCEPT`

（4）源地址转换：`iptables -t nat -A POSTROUTING -s 网关/24 -o eth0 -j MASQUERADE`

（5）允许特定IP地址（靶机）访问internet：`iptables -A FORWARD -s 靶机IP地址 -j ACCEPT`


## 配置流程图

![](https://i.imgur.com/lgD7pvG.png)

2、所有节点制作成基础镜像（见链接）

https://github.com/BiancaGuo/BiancaGuo.github.io/blob/master/_posts/VirtualBox%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%A4%9A%E9%87%8D%E5%8A%A0%E8%BD%BD%E9%85%8D%E7%BD%AE.md

			
	
