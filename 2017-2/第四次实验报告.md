# 第四次实验报告

## 使用bro来完成取证分析

### 准备工作

安装bro包并且查看机器配置信息以及是否安装成功

![image](https://github.com/BurnyMcDull/image/raw/master/hw4/1.png)

编辑bro文件信息，创建新的文件信息并且被加载

![image](https://github.com/BurnyMcDull/image/raw/master/hw4/2.png)

利用bro自动化分析pcap文件

![image](https://github.com/BurnyMcDull/image/raw/master/hw4/3.png)

将分析结果文件上传到virustotal进行匹配，生成一个报告，该报告表明这是一个已知的后门程序。

![image](https://github.com/BurnyMcDull/image/raw/master/hw4/4.png)

通过阅读main.bro的源代码

![image](https://github.com/BurnyMcDull/image/raw/master/hw4/5.png)

files.log中有文件的唯一标识。

![image](https://github.com/BurnyMcDull/image/raw/master/hw4/6.png)

通过查看files.log，发现该文件提取自网络会话标识为CP0WpmULcjBpkDTQf的FTP会话。在conn.log中可以找到对应的IP五元组信息。

![image](https://github.com/BurnyMcDull/image/raw/master/hw4/7.png)

通过conn.log的会话标识匹配，我们发现该PE文件来自于IPv4地址为：98.114.205.102的主机。
![image](https://github.com/BurnyMcDull/image/raw/master/hw4/8.png)